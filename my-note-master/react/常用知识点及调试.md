## 使用 context

### context.js

```javascript
import React from 'react';
export const MyContext = React.createContext(0);
```

### father

```javascript
import { MyContext } from './context';
class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      x: 1,
    };
  }
  render() {
    return (
      <div>
        <MyContext.Provider value={this.state.x}>
          <Child />
        </MyContext.Provider>
      </div>
    );
  }
}
```

### 子 class

```javascript
import { MyContext } from './context';
class Child extends React.Component {
  static contextType = MyContext;
  render() {
    return <h1>{this.context}</h1>;
  }
}
```

### 子 function

```javascript
import { MyContext } from './context';
function Child() {
  const context = useContext(MyContext);
  return <h1>{context}</h1>;
}
```

## 备注

**尽量用函数式开发**

1. 调用代码写在函数声明前面
1. react 的类,在实例化时候,生成每个专属的 state
1. 任何东西都可以作为 react 的 props 传递
1. 单一功能原则,每个组件原则上只能负责一件事
1. react 组件设计尽量与 json 数据模型相同
1. 不应该使用 state 去构建静态版本
1. 小应用自上而下编写,大应用自下而上编写
1. setState 是合并更新,异步更新请查阅文档
1. state 会随事件推移改变,能够通过其他的 state 计算得出值
1. 对于应用中的每一个 state：
   1. 找到根据这个 state 进行渲染的所有组件。
   1. 找到他们的共同所有者（common owner）组件（在组件层级上高于所 1. 有需要该 state 的组件）。
   1. 该共同所有者组件或者比它层级更高的组件应该拥有该 state。
   1. 如果你找不到一个合适的位置来存放该 state，就可以直接创建一个新的组件来存放该 state，并将这一新组件置于高于共同所有者组件层级的位置。
1. for 在 jsx 中应该写成 htmlFor
1. 通过可以传递多个子组件
1. false, null, undefined, true 是合法的子元素。但它们并不会被渲染。
1. [虚拟化长列表](https://zh-hans.reactjs.org/docs/optimizing-performance.html#virtualize-long-lists)
1. 在使用函数式编程的时候一样需要引入 react
1. **在使用 state 的时候如果是对象 dom 中不能直接使用**
1. useEffect 的第二个数组参数，用来定义该 hook 依赖的所有变量。依赖项中只要有一个改变，就会重新调用 useEffect 。如果依赖项是空的数组，表明我们的 hook 不依赖任何变量，因此，该 hook 只会在组件初次 mount 的时候执行。,依赖项是一个 state 比如 count 的时候,传入[count],effect 便只会在 count 更新的时候改变
1. 不要在循环，条件或嵌套函数中调用 Hook

# react 项目配置

1. create-react-app my-app
2. eslint --init
3. 复制 tsconfig.json
4. 安装 typescript

```
npx create-react-app . --template typescript
```

## 注意!!!状态管理用 asyncstorage

## typescript 配置

```
npm i -D @typescript-eslint/eslint-plugin
```

```JavaScript
module.exports = {
  env: {
    browser: true,
    es6: true,
  },
  extends: [
    'eslint:recommended',
    'plugin:react/recommended',
    'plugin:@typescript-eslint/eslint-recommended',
  ],
  globals: {
    Atomics: 'readonly',
    SharedArrayBuffer: 'readonly',
  },
  parser: '@typescript-eslint/parser',
  parserOptions: {
    ecmaFeatures: {
      jsx: true,
    },
    ecmaVersion: 2018,
    sourceType: 'module',
  },
  plugins: ['react', '@typescript-eslint'],
  rules: {
    '@typescript-eslint/no-unused-vars': 'error',
    'no-unused-vars': 0,
  },
};


```

## 配置 css module

1.

```
yarn add -D typescript-plugin-css-modules
```

2.tsconfig 配置

```
{
  "compilerOptions": {
    "plugins": [{ "name": "typescript-plugin-css-modules" }]
  }
}
```

3.src/global.d.ts

```
declare module '*.module.less' {
  const classes: { [key: string]: string };
  export default classes;
}
```

4.别忘了使用工作区的 typescript 而不是全局的

[文章地址](https://aleksandrhovhannisyan.github.io/blog/dev/how-to-set-up-react-typescript-ant-design-less-css-modules-and-eslint/#3-create-react-app-css-modules-and-typescript-)

# react-native配置

## 字体图标

android 的话需要在 android/app/build.gradle 中添加：`apply from: "../../node_modules/react-native-vector-icons/fonts.gradle"`

## 包装点击事件

```tsx
<TouchableNativeFeedback>
```

## 配置加载动画

```tsx
ActivityIndicator;
```

## statusbar 状态栏组件

```tsx
基本上模拟全屏;
hidden = true;
```

## 设置白色导航

```tsx
headerTintColor: 'white',
```

## 组件设置 border radius 不生效 触摸反馈

```tsx
   <View style={[styles.btnFather]}>
          <CustomButton
            title="下一步"
            style={[styles.btn]}
            btnTextStyle={[styles.btnText]}
            onPress={() => console.log()}></CustomButton>
        </View>

  btnFather: {
    width: '70%',
    borderRadius: 50,
    overflow: 'hidden',
    marginTop: 40,
  },
      btn: {
    width: '100%',
    height: 50,
    borderRadius: 50,
    marginLeft: 0,
  },
    思路是父组件设置border-radius 然后隐藏
```

## 异步初始化

```tsx
采用thunk;
```

## 本地图片

```
source={require('./resource/bg.gif')}
```

## 所有资源必须是 https

#### 将`usesCleartextTraffic`选项应用于调试`AndroidManifest.xml`

```xml
<!-- ... -->
<application
             android:largeHeap="true"
  android:usesCleartextTraffic="true" >
  <!-- ... -->
</application>
```

## 调试完成后注意删除权限

```
<activity android:name="com.facebook.react.devsupport.DevSettingsActivity" />
```

## 配置程序图标

```
在res目录下
分别是72 48 96 144 192 px的图标
```